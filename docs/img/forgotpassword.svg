<svg xmlns="http://www.w3.org/2000/svg" width="960" height="400">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto">
      <path d="M0,0 L10,3 L0,6 Z" fill="#000"/>
    </marker>
  </defs>
  <circle id="start" cx="40" cy="200" r="20" fill="white" stroke="black"/>
  <text x="40" y="205" font-size="10" text-anchor="middle">Start</text>
  <rect id="req" x="80" y="180" width="120" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="140" y="205" font-size="10" text-anchor="middle">Request Reset</text>
  <rect id="send" x="240" y="180" width="140" height="40" rx="5" ry="5" fill="white" stroke="black" stroke-width="3"/>
  <text x="310" y="205" font-size="10" text-anchor="middle">Send Email</text>
  <circle id="err" cx="240" cy="160" r="15" fill="white" stroke="red"/>
  <text x="240" y="165" font-size="8" text-anchor="middle">X</text>
  <rect id="fail" x="200" y="100" width="120" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="260" y="125" font-size="10" text-anchor="middle">Notify Failure</text>
  <rect id="wait" x="420" y="180" width="140" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="490" y="205" font-size="10" text-anchor="middle">Wait for OTP</text>
  <circle id="timer" cx="490" cy="260" r="20" fill="white" stroke="black"/>
  <text x="490" y="265" font-size="10" text-anchor="middle">&#x23F2;</text>
  <text x="490" y="290" font-size="10" text-anchor="middle">Cooldown</text>
  <rect id="resend" x="420" y="320" width="140" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="490" y="345" font-size="10" text-anchor="middle">Resend OTP</text>
  <polygon id="gw" points="600,180 640,200 600,220 560,200" fill="white" stroke="black"/>
  <text x="600" y="205" font-size="10" text-anchor="middle">Valid?</text>
  <rect id="update" x="660" y="180" width="140" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="730" y="205" font-size="10" text-anchor="middle">Update Credential</text>
  <rect id="lock" x="660" y="100" width="140" height="40" rx="5" ry="5" fill="white" stroke="black"/>
  <text x="730" y="125" font-size="10" text-anchor="middle">Lockout</text>
  <circle id="end" cx="840" cy="200" r="20" fill="white" stroke="black" stroke-width="3"/>
  <text x="840" y="205" font-size="10" text-anchor="middle">End</text>
  <text x="660" y="80" font-size="10">*Rollback lockout on success*</text>
  <line x1="60" y1="200" x2="80" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="200" y1="200" x2="240" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="380" y1="200" x2="420" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="560" y1="200" x2="600" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="640" y1="200" x2="660" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="800" y1="200" x2="820" y2="200" stroke="black" marker-end="url(#arrow)"/>
  <line x1="240" y1="160" x2="240" y2="140" stroke="red" marker-end="url(#arrow)"/>
  <line x1="240" y1="140" x2="200" y2="140" stroke="red" marker-end="url(#arrow)"/>
  <line x1="490" y1="220" x2="490" y2="240" stroke="black" marker-end="url(#arrow)"/>
  <line x1="490" y1="280" x2="490" y2="320" stroke="black" marker-end="url(#arrow)"/>
  <line x1="560" y1="340" x2="600" y2="220" stroke="black" marker-end="url(#arrow)"/>
  <line x1="600" y1="180" x2="600" y2="140" stroke="black" marker-end="url(#arrow)"/>
  <line x1="600" y1="140" x2="660" y2="120" stroke="black" marker-end="url(#arrow)"/>
  <line x1="730" y1="140" x2="730" y2="180" stroke="black" marker-end="url(#arrow)"/>
</svg>
