{% macro auth_card(title, subtitle='') %}
<div class="card shadow-sm mx-auto" style="max-width:480px;">
  <div class="card-body p-4">
    <h1 class="h4 text-center mb-2">{{ title }}</h1>
    {% if subtitle %}
    <p class="text-muted text-center mb-4" aria-live="polite">{{ subtitle }}</p>
    {% endif %}
    {{ caller() }}
  </div>
</div>
{% endmacro %}

{% macro form_field(name, label, type='text', placeholder='', help='', error=None, attrs=None) %}
{% set attrs = attrs or {} %}
<div class="mb-3">
  <label class="form-label" for="{{ attrs.get('id', name) }}">{{ label }}</label>
  <input class="form-control{% if error %} is-invalid{% endif %}" type="{{ type }}" name="{{ name }}" placeholder="{{ placeholder }}" {{ attrs|xmlattr }}>
  {% if help %}<div class="form-text">{{ help }}</div>{% endif %}
  {% if error %}<div class="invalid-feedback">{{ error }}</div>{% endif %}
</div>
{% endmacro %}

{% macro otp_inputs(name='code') %}
<div id="otp-group" class="d-flex gap-2 justify-content-center mb-3">
  {% for i in range(6) %}
  <input type="text" inputmode="numeric" pattern="[0-9]*" maxlength="1" class="form-control otp-input" aria-label="Digit {{ i+1 }}" {% if i==0 %}autofocus{% endif %}>
  {% endfor %}
  <input type="hidden" name="{{ name }}" id="otp-hidden">
</div>
{% endmacro %}

{% macro alerts(messages) %}
{% for cat, msg in messages %}
<div class="alert alert-{{ 'danger' if cat == 'error' else cat }}" role="alert">{{ msg }}</div>
{% endfor %}
{% endmacro %}

{% macro primary_button(text, attrs=None) %}
{% set attrs = attrs or {} %}
<button class="btn btn-brand w-100" {{ attrs|xmlattr }}>{{ text }}</button>
{% endmacro %}

{% macro secondary_button(text, attrs=None) %}
{% set attrs = attrs or {} %}
<button class="btn btn-secondary w-100" {{ attrs|xmlattr }}>{{ text }}</button>
{% endmacro %}

{% macro link_button(text, attrs=None) %}
{% set attrs = attrs or {} %}
<button class="btn btn-link p-0" {{ attrs|xmlattr }}>{{ text }}</button>
{% endmacro %}

{% macro countdown_badge(time) %}
<span class="badge text-bg-secondary" aria-live="polite">{{ time }}</span>
{% endmacro %}
