{% extends 'base.html' %}
{% block title %}Forgot your password?{% endblock %}
{% from '_components/auth_card.html' import auth_card %}
{% from '_components/form_field.html' import form_field %}
{% from '_components/buttons.html' import primary as primary_button, secondary as secondary_button, link as link_button %}
{% from '_components/otp_inputs.html' import otp_inputs %}
{% from '_components/countdown_badge.html' import countdown_badge %}
{% from '_components/alerts.html' import render_flashes %}
{% block content %}
  {{ render_flashes(get_flashed_messages(with_categories=True)) }}
  {% call auth_card('Forgot your password?') %}
    {{ form_field('email', 'email_display', 'Email', value=masked_email, attrs={'disabled':'','readonly':''}) }}
    <hr>
    <p class="text-muted mb-3" aria-live="polite">Enter the 6-digit code sent to {{ masked_email }}</p>
    <form method="post" autocomplete="off" novalidate>
      {{ form.hidden_tag() }}
      {{ otp_inputs('code') }}
      {{ primary_button('Continue', attrs={'type':'submit'}) }}
    </form>
    <div class="d-flex align-items-center gap-2 mt-3">
      {{ secondary_button('Resend', attrs={'disabled':''}) }}
      {{ countdown_badge('%02d:%02d'|format(cooldown//60, cooldown%60)) }}
    </div>
    <p class="mt-3"><a href="{{ url_for('auth.forgot') }}" class="link-secondary">Change email</a></p>
    <div class="mt-4 text-center">
      {{ link_button('Back to Sign In', url_for('auth.login')) }}
    </div>
  {% endcall %}
{% endblock %}
